parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Ir8I":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){return i(t)||n(t,e)||u(t,e)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,u=[],l=!0,s=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){s=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(s)throw i}}return u}}function i(t){if(Array.isArray(t))return t}function a(t){return s(t)||l(t)||u(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function l(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function s(t){if(Array.isArray(t))return f(t)}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function y(t,e,r){return e&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function v(e){var r=p(e,"string");return"symbol"===t(r)?r:String(r)}function p(e,r){if("object"!==t(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;c(this,t),this.initialState=e||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.state=this.initialState.map(function(t){return a(t)}),this.score=0,this.status=t.STATUS.idle}return y(t,[{key:"getState",value:function(){return this.state}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status=t.STATUS.playing,this.resetState(),this.addCells(2)}},{key:"restart",value:function(){this.resetState(),this.status=t.STATUS.idle}},{key:"resetState",value:function(){this.state=this.initialState.map(function(t){return a(t)}),this.score=0}},{key:"addCells",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=0;r<e;r++)this.addNewTile();this.isVictory()?this.status=t.STATUS.win:this.validState()||(this.status=t.STATUS.lose)}},{key:"addNewTile",value:function(){var t=this.getEmptyCells();if(t.length){var r=e(t[Math.floor(Math.random()*t.length)],2),n=r[0],i=r[1];this.state[n][i]=Math.random()<.9?2:4}}},{key:"getEmptyCells",value:function(){return this.state.flatMap(function(t,e){return t.map(function(t,r){return 0===t?[e,r]:null})}).filter(function(t){return null!==t})}},{key:"isVictory",value:function(){return this.state.flat().some(function(t){return 2048===t})}},{key:"validState",value:function(){for(var t=this.state.length,e=0;e<t;e++)for(var r=0;r<t;r++){var n=this.state[e][r];if(0===n||r<t-1&&n===this.state[e][r+1]||e<t-1&&n===this.state[e+1][r])return!0}return!1}},{key:"handleMove",value:function(e){var r=this;if(this.status===t.STATUS.playing){var n,i;switch(e){case"left":n=this.state,i=this.state.map(function(t){return r.applyMove(t)});break;case"right":i=(n=this.state.map(function(t){return a(t).reverse()})).map(function(t){return r.applyMove(t).reverse()});break;case"up":n=this.rotateRight(this.state),i=this.rotateLeft(n.map(function(t){return r.applyMove(t)}));break;case"down":n=this.rotateLeft(this.state),i=this.rotateRight(n.map(function(t){return r.applyMove(t)}));break;default:return}this.isStateEqual(this.state,i)||(this.state=i,this.addCells())}}},{key:"moveLeft",value:function(){this.handleMove("left")}},{key:"moveRight",value:function(){this.handleMove("right")}},{key:"moveUp",value:function(){this.handleMove("up")}},{key:"moveDown",value:function(){this.handleMove("down")}},{key:"applyMove",value:function(t){for(var e=t.filter(function(t){return 0!==t}),r=[],n=!1,i=0;i<e.length;i++)if(n)n=!1;else{var a=e[i];a===e[i+1]?(r.push(2*a),this.score+=2*a,n=!0):r.push(a)}for(;r.length<t.length;)r.push(0);return r}},{key:"rotateRight",value:function(t){for(var e=[],r=t[0].length,n=t.length,i=0;i<r;i++)e.push(Array.from({length:n},function(){return 0}));for(var a=0;a<n;a++)for(var o=0;o<r;o++){var u=a;e[r-1-o][u]=t[a][o]}return e}},{key:"rotateLeft",value:function(t){for(var e=[],r=t[0].length,n=t.length,i=0;i<r;i++)e.push(Array.from({length:n},function(){return 0}));for(var a=0;a<n;a++)for(var o=0;o<r;o++){var u=r-1-o;e[a][u]=t[o][a]}return e}},{key:"isStateEqual",value:function(t,e){return JSON.stringify(t)===JSON.stringify(e)}}],[{key:"STATUS",get:function(){return{idle:"idle",playing:"playing",win:"win",lose:"lose"}}}])}();module.exports=m;
},{}],"6KIz":[function(require,module,exports) {
"use strict";var e=require("../modules/Game.class"),t=new e,r=Array.from(document.querySelectorAll(".field-cell")),a=document.querySelector(".game-score"),o=document.querySelector(".button.start"),s=document.querySelector(".container"),n={idle:s.querySelector(".message-start"),lose:s.querySelector(".message-lose"),win:s.querySelector(".message-win")};function l(){var e=t.getState();r.forEach(function(t,r){var a=Math.floor(r/4),o=r%4,s=e[a][o];t.className="field-cell field-cell--".concat(s),t.textContent=0===s?"":s}),a.textContent=t.getScore(),c()}function c(){var e=t.getStatus();for(var r in n)if(Object.hasOwnProperty.call(n,r)){var a=n[r];a&&a.classList.toggle("hidden",r!==e)}}function i(){t.getStatus()===e.STATUS.idle||t.getStatus()===e.STATUS.lose||t.getStatus()===e.STATUS.win?(t.start(),o.textContent="Restart",o.classList.remove("start"),o.classList.add("restart")):t.getStatus()===e.STATUS.playing&&(t.restart(),t.start()),l()}function u(r){if(t.getStatus()===e.STATUS.playing){switch(r.key){case"ArrowLeft":t.handleMove("left");break;case"ArrowRight":t.handleMove("right");break;case"ArrowUp":t.handleMove("up");break;case"ArrowDown":t.handleMove("down");break;default:return}l()}}o.addEventListener("click",i),document.addEventListener("keydown",u),l(),c();
},{"../modules/Game.class":"Ir8I"}]},{},["6KIz"], null)
//# sourceMappingURL=main.486d8b18.js.map